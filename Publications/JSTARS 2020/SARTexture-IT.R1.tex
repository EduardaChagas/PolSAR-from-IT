\documentclass[journal]{IEEEtran}

\usepackage{subfigure}
\usepackage{caption}  
\usepackage[english]{babel} 
\usepackage{amsfonts,amsmath,bm,bbm}
\usepackage{hyperref} 
\usepackage{graphicx,xurl}
\usepackage{rotating}
\usepackage{xcolor} 
\usepackage{tikz}
\usepackage{ifthen}
\usepackage{color}
\usepackage{multicol,multirow}
\usepackage{float}
\usepackage{siunitx}
\usepackage{algorithm,algorithmicx,algpseudocode}
\usepackage{booktabs}
\usepackage{scalerel}
\usetikzlibrary{svg.path}

\definecolor{orcidlogocol}{HTML}{A6CE39}
\tikzset{
orcidlogo/.pic={
	\fill[orcidlogocol] svg{M256,128c0,70.7-57.3,128-128,128C57.3,256,0,198.7,0,128C0,57.3,57.3,0,128,0C198.7,0,256,57.3,256,128z};
	\fill[white] svg{M86.3,186.2H70.9V79.1h15.4v48.4V186.2z}
	svg{M108.9,79.1h41.6c39.6,0,57,28.3,57,53.6c0,27.5-21.5,53.6-56.8,53.6h-41.8V79.1z M124.3,172.4h24.5c34.9,0,42.9-26.5,42.9-39.7c0-21.5-13.7-39.7-43.7-39.7h-23.7V172.4z}
	svg{M88.7,56.8c0,5.5-4.5,10.1-10.1,10.1c-5.6,0-10.1-4.6-10.1-10.1c0-5.6,4.5-10.1,10.1-10.1C84.2,46.7,88.7,51.3,88.7,56.8z};
}
}

\newcommand\orcidicon[1]{\href{https://orcid.org/#1}{\mbox{\scalerel*{
			\begin{tikzpicture}[yscale=-1,transform shape]
			\pic{orcidlogo};
			\end{tikzpicture}
		}{|}}}}


\renewcommand{\Bbb}{\mathbb}

\newdimen\HilbertLastX
\newdimen\HilbertLastY
\newcounter{HilbertOrder}

\def\DrawToNext#1#2{%
\advance \HilbertLastX by #1
\advance \HilbertLastY by #2
\pgfpathlineto{\pgfqpoint{\HilbertLastX}{\HilbertLastY}}
}

% \Hilbert[right_x,right_y,left_x,left_x,up_x,up_y,down_x,down_y]
\def\Hilbert[#1,#2,#3,#4,#5,#6,#7,#8] {
\ifnum\value{HilbertOrder} > 0%
\addtocounter{HilbertOrder}{-1}
\Hilbert[#5,#6,#7,#8,#1,#2,#3,#4]
\DrawToNext {#1} {#2}
\Hilbert[#1,#2,#3,#4,#5,#6,#7,#8]
\DrawToNext {#5} {#6}
\Hilbert[#1,#2,#3,#4,#5,#6,#7,#8]
\DrawToNext {#3} {#4}
\Hilbert[#7,#8,#5,#6,#3,#4,#1,#2]
\addtocounter{HilbertOrder}{1}
\fi
}

% \hilbert((x,y),order)
\def\hilbert((#1,#2),#3){%
\advance \HilbertLastX by #1
\advance \HilbertLastY by #2
\pgfpathmoveto{\pgfqpoint{\HilbertLastX}{\HilbertLastY}}
\setcounter{HilbertOrder}{#3}
\Hilbert[1mm,0mm,-1mm,0mm,0mm,1mm,0mm,-1mm]
\pgfusepath{stroke}%
}

% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}


\begin{document}

\title{Analysis and Classification of SAR Textures using Information Theory}

\author{Eduarda~T.~C.~Chagas \orcidicon{0000-0001-9647-0506},
Alejandro~C.~Frery \orcidicon{0000-0002-8002-5341},
\IEEEmembership{IEEE~Senior~Member,}
Osvaldo~A.~Rosso \orcidicon{0000-0002-1288-2528},
and~Heitor~S.~Ramos \orcidicon{0000-0003-4523-6466},\IEEEmembership{IEEE~Senior~Member}
	
	\thanks{E.\ T.\ C.\ Chagas and H.\ S.\ Ramos ar with Departamento de Ci\^encia da Computa\c c\~ao, Universidade Federal de Minas Gerais, Belo Horizonte, Minas Gerais, Brazil (e-mail: eduarda.chagas@dcc.ufmg.br, ramosh@dcc.ufmg.br).}
	\thanks{A.\ C.\ Frery is with the School of Mathematics and Statistics, Victoria University of Wellington, 6140 New Zealand; (e-mail: alejandro.frery@vuw.ac.nz)}
	\thanks{O.\ A.\ Rosso is with Instituto de F\'isica, Universidade Federal de Alagoas, Brasil (e-mail: oarosso@if.ufal.br)}
	\thanks{Manuscript received XX YY, 20ZZ; revised WW UU, 20VV.}}


\markboth{IEEE JOURNAL OF SELECTED TOPICS IN APPLIED EARTH OBSERVATIONS AND REMOTE SENSING}
%\markboth{IEEE JOURNAL OF SELECTED TOPICS IN APPLIED EARTH OBSERVATIONS AND REMOTE SENSING,~Vol.~13, No.~9, September~2014}%
{Shell \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for Journals}

\maketitle

\begin{abstract}
	The use of Bandt-Pompe probability distributions and descriptors of Information Theory has been presenting satisfactory results with low computational cost in the time series analysis literature~\cite{Aquino2017Characterization, Rosso2016Signatures, Schieber2016network}.
	However, these tools have limitations when applied to data without time dependency.
	Given this context, we present a newly proposed technique for texture analysis and classification based on the Bandt-Pompe symbolization for SAR data.
	It consists of
	(i)~linearize a \mbox{2-D} patch of the image using the Hilbert-Peano curve,
	(ii)~build an Ordinal Pattern Transition Graph that considers the data amplitude encoded into the weight of the edges;
	(iii)~obtain a probability distribution function derived from this graph;
	(iv)~compute Information Theory descriptors (Permutation Entropy and Statistical Complexity) from this distribution and use them as features to feed a classifier.
	The ordinal pattern graph we propose considers that the edges' weight is related to the absolute difference of observations, which encodes the information about the data amplitude. 
	This modification considers the scattering properties of the target and leads to the characterization of several types of textures.
	Experiments with data from Munich urban areas, Guatemala forest regions and Cape Canaveral ocean samples show the effectiveness of our technique in homogeneous areas, achieving satisfactory separability levels.
	The two descriptors chosen in this work are easy and quick to calculate and are used as input for a k-nearest neighbor classifier.
	Experiments show that this technique presents results similar to state-of-the-art techniques that employ a much larger number of features and, consequently, impose a higher computational cost.
\end{abstract}

\begin{IEEEkeywords}
	Synthetic Aperture Radar (SAR), 
	Texture, 
	Terrain Classification,		
	Permutation Entropy, 
	Ordinal Patterns Transition Graphs.
\end{IEEEkeywords}

\IEEEpeerreviewmaketitle
%\tableofcontents

\section{Introduction}\label{Sec:Intro}

\IEEEPARstart{T}exture is an elusive trait.
When dealing with remotely sensed images, the texture of different patches carries relevant information that is hard to quantify and transform into useful and parsimonious features.
This may be since textures, in this context, is a synesthesia phenomenon that triggers tactile responses from visual inputs.
This paper presents a new way of extracting features from textures, both natural and resulting from anthropic processes, in SAR (Synthetic Aperture Radar) imagery.

SAR systems are a vital source of data because they provide high-resolution images in almost all weather and day-night conditions.
They provide basilar information, complementary to that offered by sensors that operate in other regions of the electromagnetic spectrum, for a variety of Earth Observation applications.	
Although they present rich information, such data have challenging characteristics.
Most notably, they do not follow the usual Gaussian additive model, and the signal-to-noise ratio is usually low.

Yue et al.~\cite{Yue2020Gaussian} provide a comprehensive account of how the physical properties of the target are translated into first- and second-order statistical properties of SAR intensity data.
There is general agreement that non-deterministic textures are encoded in the second-order features, i.e., in the spatial correlation structure.
Therefore is frequent the use of covariance matrix and other measures that assume that a linear dependence, namely the Pearson correlation coefficient, suffices to characterize natural textures.
However, in SAR imagery, texture is often visible only over large areas, and the multiplicative and non-Gaussian nature of speckle antagonizes with the additive assumption that underlies classical approaches, making complex the process of characterizing such data.

Surface classification and land use are among the most critical applications of the Synthetic Aperture Radar (SAR) image~\cite{Pottier2004Unsupervised}.
In recent years, handcrafted features and representation learning (supervised and unsupervised) algorithms have been proposed~\cite{han2020unsupervised, huang2020classification, xie2020polsar}.
Algorithms of the unsupervised generative adversarial network (GAN) have revolutionized the classification of SAR images, improving performance in small sample problems, and helping the interpretability of such data~\cite{liu2019task}.
Among the supervised algorithms, support vector machine (SVM)~\cite{sukawattanavijit2017ga}, random forest (RF)~\cite{mcnairn2014early}, and neural network (NN)~\cite{lin2017deep} have been frequently used in remote sensing.
The Principle Component Analysis (PCA)~\cite{ressel2015neural}, autoencoder~\cite{wang2019classification} and the Boltzmann machine~\cite{qin2017object} can to extract non-local resources and classify non-labeled PolSAR pixels using an unsupervised approach.
However, methods such as graph-based semi-supervised deep learning algorithms~\cite{bi2018graph} can improve classification accuracy in problems with few labeled samples.

Handcrafted features in SAR textures can be studied following two complementary approaches, namely analyzing the marginal properties of the data (first-order statistics), and observing their spatial structure~\cite{Yue2020Gaussian, numbisi2018multi}.
In this work, we focus on the second approach, which shows relevant results using techniques from the image processing literature, such as co-occurrence matrices and Haralick's descriptors~\cite{yu2019detection}.
Through the gray-level co-occurrence matrices (GLCM), we can extract features that reflect statistical relationships of the pixel intensity values.
On the other hand, Haralick's descriptors can capture information on intensity and amplitude based on global statistics of SAR images.
Radford et al.~\cite{radford2018geological} used textural information derived from GLCM, along with Random Forests, for geological mapping of remote and inaccessible localities; the authors obtained a classification accuracy of $\approx\SI{90}{\percent}$, even when using limited training data ($\approx\SI{0.15}{\percent}$ of the total data). 	
Hagensieker and Waske~\cite{hagensieker2018evaluation} evaluated the synergistic contribution of multi-temporal L-, C-, and X-band data to tropical land cover mapping, comparing classification outcomes of ALOS-2~\cite{kankaku2013alos}, RADARSAT-2~\cite{morena2004introduction}, and TerraSAR-X~\cite{breit2009terrasar} datasets for a study site in the Brazilian Amazon using a wrapper approach. 
The wrapper utilizes the gray-level co-occurrence matrix texture information and a  Random Forest classifier to estimate scene importance. 	
Storie~\cite{storie2018urban} proposed an open-source workflow for detecting and delineating the urban-rural boundary using Sentinel-1A SAR data.
The author used a combination of GLCM information and a k-means classifier to produce a three-category map that distinguishes urban from rural areas. 
In higher resolution image classification activities, it is necessary to obtain more granular information from the data by extracting local characteristics such as scale and orientation.
In this scenario, techniques such as Fourier power spectrum~\cite{Florindo2012Fractal}, random fields~\cite{zhu2016antarctic}, Gabor filter~\cite{dumitru2014information} and wavelet transform~\cite{akbarizadeh2012new} are usually applied.

In our approach, we opt to analyze the \mbox{1-D} signals resulting from the linearization of the image samples, using non-parametric time series analysis techniques.
With this approach, we reduce the dimensionality of the data while preserving the spatial correlation structure.
Observations are then transformed into ordinal patterns with the Bandt-Pompe symbolization.
We use Information Theory descriptors to analyze the distributions these patterns induce, both directly and by building transition graphs among subsequent patterns.
Those descriptors are the Entropy and the Statistical Complexity, which are easy to obtain and are interpretable.
They reveal important features of the underlying process.

The following question guides us:
\begin{quote}
What is the best representation of a texture patch that allows extracting expressive Information Theory descriptors to characterize textures in the presence of speckle?
\end{quote}
We verified that both the histogram of Bandt-Pompe ordinal patterns and classical transition graphs do not convey enough information for suitable applications as, for instance, classification.

Henceforth, we propose the Weighted Amplitude Transition Graph (WATG).
This graph incorporates the absolute difference among observations as weights of the edges between nodes transitions.
Such weights take part in the computation of the probabilities and, thus, influence both Entropy and Statistical Complexity.

This work's main contribution is the proposal of a new representation of SAR textures, which allows a low-dimensional characterization useful for, among other applications, their classification.
We compare its performance with the classical histograms of Bandt-Pompe ordinal patterns and the regular transition graph.
Since the proposed approach has a low computational cost, the results obtained suggest that this technique has good potential in other applications, such as texture segmentation tools of SAR images.

The paper is structured as follows:
Section~\ref{methodology} describes our proposed methodology.
Section~\ref{linearization} presents the patch linearization process of the images.
In the Section~\ref{BP} we report the Bandt-Pompe symbolization process.
Section~\ref{OPTG} describes the ordinal patterns of transition graphs.
Section~\ref{WATG} shows our technique of ordinal amplitude transition graph weighting by amplitudes.
In Section~\ref{HC} we report the Information Theory descriptors used throughout this work.
Section~\ref{Methods} we summarize the weighted ordinal patterns methods used to compare with our proposal.
Section~\ref{Results} describe the SAR image datasets, 
the analysis of ordinal pattern methods, 
experiments of sliding window selection, 
and a quantitative assessment.
Finally, Section~\ref{Conclusion} concludes the paper.

\section{Methodology}\label{methodology}

As outlined in Section~\ref{Sec:Intro}, we are interested in methods that employ Information Theory descriptors obtained from ordinal patterns.
Such techniques are defined for time series, so the first step of our proposal consists of turning \mbox{2-D} image patches into a \mbox{1-D} signal; this is discussed in Section~\ref{linearization}.
The second step, presented in Section~\ref{BP} is obtaining the ordinal patterns.
Such patterns can be used directly, or be the basis for building transition graphs; these graphs and their variants are described in Sections~\ref{OPTG} and~\ref{Methods}.
Our proposal is detailed in Section~\ref{WATG}, and its properties are assessed in Section~\ref{Sec:WATGProperties}

All these transformations produce different empirical probability distributions.
The final features computed on these distributions are the Entropy and Statistical Complexity, which are discussed in Section~\ref{HC}.


\subsection{Linearization of image patches}\label{linearization}

We perform a data dimensionality reduction by turning the \mbox{2-D} patch into a \mbox{1-D} signal.
This could be accomplished by reading the data by lines, columns, or any transformation of \mbox{2-D} indexes into a sequence of integers.
In this work, we chose to use the Hilbert-Peano~\cite{Lee1994Texture} curve, due to its low computational cost and its ability to preserve relevant properties of pixel spatial correlation.

Nguyen et al.~\cite{nguyen1982space} firstly employed Space-filling curves, to map texture into a one-dimensional signal.
Carincotte et al.~\cite{Carincotte2006changeDetection} used the Hilbert-Peano curve in the problem of change detection in pairs of SAR images.
The authors noted that this transformation exploits the spatial locality and that its pseudo-randomness
of direction changes work well for a large family of images, especially
natural ones.

Assuming an image patch is supported by an $M \times N$ grid, we have the following definition.

\newtheorem{mydef}{Definition}
\begin{mydef}
	An image scan is a bijective function $f \colon \mathbbm{N} \times \mathbbm{N} \to \mathbbm{N}$ in the ordered pair set $ \{(i, j): 1 \leq i \leq M , 1 \leq j \leq N\}$, which denotes the points in the domain, for the closed range of integers $\{1, \dots, M  N\}$.
	A scan rule is $\{f^{-1}(1), \dots, f^{-1}(M  N)\}$.
	\label{def:CurveFilling}
\end{mydef}
This Definition imposes that each pixel is visited only once and that all pixels are visited.

Space-filling curves, such as raster-1, raster-2, and Hilbert-Peano scanning techniques, stipulate a proper function $f$.
Hilbert-Peano curves scan an array of pixels of dimension $2^k \times 2^k$, $k \in \mathbbm{N}$, never keeping the same direction for more than three consecutive points, as shown in Fig.~\ref{fig:Hilbert}.
Using the Hilbert-Peano curve, we reduce the data dimensionality while maintaining the patch's spatial dependence information.
In this work, we use Hilbert-Peano patches of size $128 \times 128$.

\begin{figure}%[H]
	\centering
	\tikz[scale=3.2] \hilbert((0mm,0mm),3);
	\hspace{0.3cm}
	\tikz[scale=1.5] \hilbert((0mm,0mm),4);
	\hspace{0.3cm}
	\tikz[scale=0.73] \hilbert((0mm,0mm),5);	
	\caption{Hilbert-Peano curves in areas of: (a)~$8 \times 8$, (b)~$16 \times 16$, and (c)~$32 \times 32$ pixels. }\label{fig:Hilbert}
\end{figure} 

Figs.~\ref{Fig:figGuatemala}, \ref{Fig:figCape1}, \ref{Fig:figCape2}, \ref{Fig:figMunich}, and~\ref{Fig:figPasture} show five image patches with different textures.
Figs.~\ref{Fig:TSGuatemala}, \ref{Fig:TSCape1}, \ref{Fig:TSCape2}, \ref{Fig:TSMunich}, and~\ref{Fig:TSPasture} present their 1-D representation as signals. 

\subsection{Bandt-Pompe Symbolization}\label{BP}

Bandt and Pompe~\cite{Bandt2002Permutation} introduced the representation of time series by ordinal patterns as a transformation resistant to noise, and invariant to nonlinear monotonic transformations.
The first step of the \texttt{WATG} subroutine is to calculate the ordinal patterns of the \mbox{1-D} signal by Band-Pompe symbolization.

Consider ${\mathcal X} \equiv \{x_t\}_{t=1}^{T}$ a real valued time series of length $T$. 
Let ${\mathfrak A}_{D}$ (with $D \geq 2$ and $D \in {\Bbb N}$) be the symmetric group of order $D!$ formed by all 
possible permutation of order $D$, and the symbol component vector 
${\bm \pi}^{(D)} = (\pi_1, \pi_2, \dots, \pi_D)$ so every element ${\bm \pi}^{(D)}$ is unique 
($\pi_j \neq \pi_k$ for every $j \neq k$). 
Consider for the time series ${\mathcal X} \equiv \{x_t\}_{t=1}^{T}$ its time delay embedding representation,
with embedding dimension $D \geq 2$ and time delay $\tau \geq 1$ ($\tau \in {\Bbb N}$, also called ``embedding time,'' ``time delay'', or ``delay''):
\begin{equation} 
\label{eq:time-delay}
{\mathbf X}^{(D,\tau)}_t =( x_t,x_{t+\tau},\dots,x_{t+(D-1)\tau} ) ,
\end{equation} 
for $t = 1,2,\dots,N$ with $N = T-(D-1) \tau$.
Then the vector ${\mathbf X}^{(D,\tau)}_t$ can be mapped to a symbol vector ${\bm \pi}_t^D \in {\mathfrak A}_{D}$. 
This mapping is such that preserves the desired relation between the elements 
$x_t  \in {\mathbf X}^{(D,\tau)}_t$, and all $t \in \{1,\dots,T-(D-1)\tau\}$ that share this pattern (also called ``motif'') are mapped to the same 
${\bm \pi}_t^{D}$.

We define the mapping ${\mathbf X}_t^{(D,\tau)} \mapsto {\mathbf \pi}_t^{D}$ by ordering the observations $x_t \in {\mathbf X}_t^{(D,\tau)}$ in increasing order.
Consider the time series $\mathcal X = (1.8, 1.2, 3.2, 4.8, 4.2, 4.5, 2.3, 3.7, 1.2, .5)$ depicted in Fig.~\ref{Fig:IntroBP}.
Assume we are using patterns of length $D=5$ with unitary time lag $\tau=1$.
The code associated to $\mathbf X_{3}^{(5,1)}=(x_3,\dots,x_7)=(3.2, 4.8, 4.2, 4.5, 2.3)$, shown in black, is formed by the indexes in $\bm\pi_3^{5}=(1,2,3,4,5)$ which sort the elements of $\mathbf X_{3}^{(5,1)}$ in increasing order: $51342$.
With this, $\widetilde{\pi}_3^{5} = 51342$, and we increase the counting related to this motif in the histogram of all possible patterns of size $D=5$.

The dash-dot line in Fig.~\ref{Fig:IntroBP} illustrates $\mathbf X_{1}^{(5,2)}$, i.e. the sequence of length $D=5$ starting at $x_1$ with lag $\tau=2$.
In this case, $\mathbf X_{1}^{(5,2)}= (1.8, 3.2, 4.2, 2.3, 1.2)$, and the corresponding motif is $\widetilde{\pi}_1^{5}=51423$.

\begin{figure}%[H]
	\centering
	\includegraphics[width=.9\linewidth]{Figures/IntroBP.pdf}
	\caption{Illustration of the Bandt and Pompe coding\label{Fig:IntroBP}}
\end{figure}

The classic approach to calculating the probability distribution of ordinal patterns is through the frequency histogram.
Denote $\Pi$ the sequence of symbols obtained by a given series $\mathbf{X}_t^{(D,\tau)}$.
The Bandt-Pompe probability distribution is the relative frequency of symbols in the series against the $D!$ possible patterns $\{\widetilde\pi_t^D \}_{t = 1}^{D!}$:
\begin{equation}
p(\widetilde\pi_t^D) = \frac{\#\left \{\mathbf{X}_t^{(D,\tau)} \text{ is of type } \widetilde\pi_t^D\right \}}{T- (D-1)\tau},  
\end{equation}
where  $t\in \{1, \dots, T-(D-1)\tau\}$.
These probabilities meet the conditions $p(\widetilde\pi_t^D) \ge 0$ and  $\sum_{i=1}^{D!} p(\widetilde\pi_t^D) = 1$, and are invariant before monotonic transformations of the time series values.
For example, the presence of $\alpha$ multiplicative noise in ${\mathcal X}$ does not change the results of the patterns produced.

\subsection{Graph of Transitions between Ordinal Patterns}\label{OPTG}

Alternatively, one may form an oriented graph with the transitions from $\widetilde\pi_t^D$ to $\widetilde\pi_{t+1}^D$. 
The Ordinal Pattern Transition Graph ${G} = ({V}, {E})$ 
represents the transitions between two consecutive ordinal patterns over time $t$.
The vertices are the patterns, and the edges the transitions between them:
$V = \{v_{\widetilde\pi_t^D}\}$, and 
$E = \{(v_{\widetilde\pi_t^D}, v_{\widetilde\pi_{t+1}^D}): v_{\widetilde\pi_t^D}, v_{\widetilde\pi_{t+1}^D} \in V \}$~\cite{Borges2019Transition}.

The literature reports two approaches to compute the weight of edges.
Some authors employ unweighted edges~\cite{McCullough2015lagged, Kulp2016ordinal}, which represent only the existence of transitions, while others apply the frequency of transitions~\cite{Sorrentino2015periodic, Zhang2017ConstructingOP}.
The weights $\mathbbm{W} = \{w_{v_{\widetilde{\pi}^D_i}, v_{\widetilde\pi^D_j}}: v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j} \in V \}$ assigned to each edge describe the chance of transitions between the patterns $(v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j})$
The weights are calculated as the relative frequency of each transition, i.e.:
\begin{equation}
w_{v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}} = \frac{|\Pi_{\widetilde\pi^D_i,\widetilde\pi^D_j}|}{T-(D-1)\tau-1},
\end{equation}
where $|\Pi_{\widetilde\pi^D_i,\widetilde\pi^D_j}|$ is the number of transitions from pattern $\widetilde\pi^D_i$ to pattern $\widetilde\pi^D_j$, $\sum_{v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}}w_{v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}} = 1$,
and the denominator is the number of transitions between sequential patterns in the series of motifs of length $T-(D-1)\tau$.

\subsection{Weighted Ordinal Patterns Methods}\label{Methods}

Recent works proposed using weights in the calculation of relative frequencies for ordinal patterns.
They all aim at incorporating the information coded in the amplitude of the observations back into the Permutation Entropy.
We summarize in the following those that we used for comparison with our proposal.

\subsubsection{Weighted Permutation Entropy}\label{WPE}

The Weighted Permutation Entropy (WPE) was proposed by Fadlallah et al.~\cite{Fadlallah2013Weightedpermutation}. 

Denote $\overline{X}_t^{(D, \tau)}$ the arithmetic mean:
\begin{equation}
\overline{X}_t^{(D, \tau)} = \frac{1}{D} \sum_{k = 1}^{D} x_{t + (k - 1)}.
\end{equation}
The weight $w_{t}$ is the sample variance of each vector $X_t^{(D, \tau)}$:
\begin{equation}
w_{t} = \frac{1}{D} \sum_{k = 1}^{D}\big[x_{t + (k - 1)} - \overline{X}_t^{(D, \tau)}\big]^2 .
\end{equation}
Then, the probability distribution is given from the weighted relative frequencies:
\begin{equation}
p(\widetilde \pi_t^D) = \frac{\sum_{i : \{\mathbf{X}^{(D,\tau)}_i \mapsto \widetilde\pi^D_t\}} w_{i}}{\sum_{i = 1}^{T-(D-1)\tau} w_{i}}.
\end{equation}

Fig.~\ref{Fig:UrbanWATG} shows the weighted graph produced by the urban area shown in Figs.~\ref{Fig:figMunich} (as image) and~\ref{Fig:TSMunich} (as signal).

\subsubsection{Fine-Grained Permutation Entropy}\label{FGPE}

The Fine-Grained Permutation Entropy (FGPE) was introduced in Ref.~\cite{xiao2009fine}.

Let $\beta_t$ be the difference series:
\begin{equation}
\beta_t = \big\{|x_{t+1} - x_t|, \dots, |x_{t+(D-1)} - x_{t+(D-2)}|\big\}.
\end{equation}
The weight $w_t$ quantifies such differences:
\begin{equation}
w_t = \left \lfloor \frac{\max\{\beta_t\}}{\alpha s(\beta_t) } \right \rfloor,
\end{equation}
where $s$ is the sample standard deviation,
$\alpha$ is a user-defined parameter, 
and $\lfloor\cdot \rfloor$ is the floor function.
Then, $w_t$ is added as a symbol at the end of the corresponding pattern, leading to an update of $\Pi$:
\begin{equation}
\pi{'}_t^D = \{ \widetilde \pi_t^D \cup w_t\}.
\end{equation} 
Finally, the probability distribution is calculated as:
\begin{equation}
p(\pi{'}_t^D) = \frac{\#\left \{\mathbf{X}_t^{(D,\tau)} \text{ is of type } \pi{'}_t^D\right \}}{T- (D-1)\tau}.
\end{equation}

\subsubsection{Amplitude-Aware Permutation Entropy}\label{AAPE}

The Amplitude-Aware Permutation Entropy (AAPE) was proposed in Ref.~\cite{azami2016amplitude}.
It consists of weighting the amplitude of ordinal patterns by both the mean and the differences of the elements.
For this, only an additional parameter $ A \in [0, 1]$ is required:
\begin{multline}
w_t = \frac{A  |x_t|}{D} + \\ \sum_{k = 1}^{D - 1} \left(\frac{A  |x_{t + k}|}{D} + \frac{(1 - A)  |x_{t+k} - x_{t+k-1}|}{D - 1}\right).
\end{multline}
The probability distribution is given from the weighted relative frequencies:
\begin{equation}
p(\widetilde \pi_t^D) = \frac{\sum_{i : \{\mathbf{X}^{(D,\tau)}_i \mapsto \widetilde\pi^D_t\}} w_{i}}{\sum_{i = 1}^{T-(D-1)\tau} w_{i}}.
\end{equation}

\subsection{Weighted Graph of Transitions between Ordinal Patterns -- WATG}\label{WATG}

%Our proposal for computing the probability distribution, henceforth referred to as Weighted Amplitude Transition Graph (WATG), takes into account the dispersion of the return values, leading to a good.
%We propose a modification of the current ordinal pattern transition graph, incorporating the absolute difference between the observations that produced the patterns.
% In general, we know that the intensity of dispersion in urban areas is stronger than in forest regions.
% Most man-made targets are anisotropic scatterers because their particular shape determines the relationship between their scatterings and directions of vision.
% Natural targets, such as lawns and forests, are generally isotropic in flat areas because they produce volume scatterings with random phases.
% In this way, we can correlate non-stationary targets with man-made targets and correlate stationary targets with natural targets.
% Since WATG consists of a proposal for weighting the edges of the transition graph based on the amplitude of the signal, information on the intensity of dispersion can be captured and used to distinguish classes of regions.

% On the other hand, water surfaces cause the mirror-like reflection to reflect incident electromagnetic wave away from the sensor.
% This results in a particularly low backscatter which, in turn, thanks to the multiplicative noise, translates into a homogeneous region, almost without characteristics and without textures.
% At WATG we know that when the 1-D signal presents a uniform amplitude variation, the weights are well distributed between the edges, thus obtaining a near uniform distribution, and, consequently, a high entropy.
% It is known that for SAR imagery, non-stationary 

Most man-made targets are anisotropic scatterers because their particular shape determines the relationship between their scatterings and vision directions.
Natural targets, such as lawns and forests, are generally isotropic in flat areas because they produce volume scatterings with random phases. In this way, we can associate non-stationary signals with man-made targets and stationary signals with natural targets.  Water surfaces cause the mirror-like reflection of the incident electromagnetic wave. It results in an unusually low backscatter, which, thanks to multiplicative noise, translates into a homogeneous region, almost without characteristics and without textures~\cite{wu2013man}.

Our proposal hereinafter referred to  Weighted Amplitude Transition Graph (WATG), differs from the traditional ordinal pattern transition graph by incorporating the absolute difference between successive patterns. Since WATG encodes the amplitude of the signal into the edges' weights, the information on the intensity of dispersion can be captured and used to distinguish classes of regions. Our hypothesis is that such encoding is effective to discriminate the regions captured by SAR imagery.

% We know that we can correlate non-stationary targets with man-made targets and stationary targets with natural targets due to the characteristics of their dispersers
% The water surfaces have a particularly low backscatter, which, in turn, thanks to the multiplicative noise, translates into a homogeneous region, almost without characteristics and without textures.
% In this way, with WATG information on the intensity of the dispersion can be captured and used to distinguish classes of regions.

First, each $\mathcal{X}$ time series is scaled to $[0, 1]$, since we are interested in a metric able to compare datasets:
\begin{equation}
\frac{x_i - x_{\min}}{x_{\max} - x_{\min}} \longmapsto x_i,
\end{equation}
where $x_{\min}$ and $x_{\max}$ are, respectively, the minimum and maximum values of the series.
This transformation is relatively stable before contamination, e.g., if instead of $x_{\max}$ we observe $k x_{\max}$ with $k\geq 1$, the relative values are not altered. Nevertheless, other more resistant transformations as, for instance, $z$ scores, might be considered.

Each $\mathbf{X}^{(D, \tau)}_t$ vector is associated with a weight $\beta_t$ that measures the largest difference between its elements:
\begin{equation}
\beta_t = \max\{|x_i - x_j|\},
\end{equation}
where $x_i, x_j \in \mathbf{X}^{(D, \tau)}_t$.

We propose that the weight assigned to each edge is proportional to the amplitude difference observed in the transition:	
\begin{equation}
w_{v_{\widetilde \pi^D_i}, v_{\widetilde \pi^D_j}} =  \sum_{i : \{\mathbf{X}^{(D,\tau)}_t \mapsto \widetilde\pi^D_i\}} \sum_{j : \{\mathbf{X}^{(D,\tau)}_t \mapsto \widetilde\pi^D_j\}} |\beta_i - \beta_j| .
\end{equation}
Thus, the probability distribution taken from the weighted amplitude transition graph is given as follows:	
\begin{align}
&\left\{\begin{array}{l}
\lambda_{v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}} = 1, \text{ if } (v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}) \in {E}, \\
\lambda_{v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}} = 0, \text{ otherwise}.
\end{array}\right., \text{ and} \\
&p(\widetilde\pi^D_i, \widetilde\pi^D_j) = \frac{\lambda_{v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}} \cdot w_{v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}}}{\sum_{v_{\widetilde\pi^D_a}, v_{\widetilde\pi^D_b}} w_{v_{\widetilde\pi^D_a}, v_{\widetilde\pi^D_b}}}.
\end{align}

Note that  $p(\widetilde\pi^D_i, \widetilde\pi^D_j) \ge 0$ and $\sum_{\widetilde\pi^D_i, \widetilde\pi^D_j} p(\widetilde\pi^D_i, \widetilde\pi^D_j) = 1$, so $p$ is a probability function.

Thus, series with uniform amplitudes have edges with the probability of occurrence well distributed along with the graph, while those with large peaks have edges with the probability of occurrence much higher than the others.

Fig.~\ref{Fig:UrbanWATG} shows the weighted graph produced by the urban  area shown in Figs.~\ref{Fig:figMunich} (as image) and~\ref{Fig:TSMunich} (as signal) using this approach.
Notice the difference in weights when compared with Fig.~\ref{Fig:UrbanWATG}, which was obtained with WPE.


\subsection{Information-Theoretic Descriptors}\label{HC}

We chose two Information Theory descriptors: Shannon Entropy and Statistical Complexity.
Computing these quantities is the last step of the algorithm, i.e., obtaining the point in the $H \times C$ plane.

Entropy measures the disorder or unpredictability of a system characterized by a probability measure $\mathbbm{P}$.
Let $\mathbbm{P} = \{p_{(\widetilde\pi^D_1, \widetilde\pi^D_1)}, p_{(\widetilde\pi^D_1, \widetilde\pi^D_2)}, \dots, p_{(\widetilde\pi^D_{D!}, \widetilde\pi^D_{D!})} \} = \{p_1,\dots,p_{D!^2}\}$ be the probability function obtained from the \mbox{1-D} signal weighted amplitude transition graph $\mathbbm{X}$.
Its normalized Shannon entropy is given by:	
\begin{equation}
H(\mathbbm{P}) = -\frac1{2\log D!}\sum_{\ell=1}^{D!^2} p_{\ell} \log p_{\ell} .
\label{eq:Entropia}
\end{equation}

The entropy's ability to capture system properties is limited, so it is necessary to use it in conjunction with other des\-criptors to obtain a complete analysis.
Other interesting measures are the distances between $\mathbbm{P}$ and a probability measure that describes a non-informative process, typically the uniform distribution.

The Jensen-Shannon distance to the uniform distribution $\mathbbm{U} = (\frac{1}{D!^2}, \dots, \frac{1}{D!^2})$ is a measure of how similar the underlying dynamics is to a non-informative process.
It is calculated as:
\begin{equation}
Q'(\mathbbm{P}, \mathbbm{U}) = \sum_{\ell=1}^{D!^2} \Big(p_\ell \log\frac{p_\ell}{u_\ell} +
u_\ell \log\frac{u_\ell}{p_\ell}
\Big).
\end{equation}
This quantity is also called ``disequilibrium.''
The normalized disequilibrium is $ Q=Q'/\max\{Q'\}$.

Conversely to entropy, the statistical complexity seeks to find interaction and dependence structures among the elements of a given series, being an extremely important factor in the study of dynamic systems.
The Statistical Complexity is defined as~\cite{Lamberti2004Entropic}:
\begin{equation}
C(\mathbbm{P}, \mathbbm{U}) = H(\mathbbm{P}) Q(\mathbbm{P}, \mathbbm{U}).
\end{equation}

In our analysis, each time series can then be described by a point $(H(\mathbbm{P}), C(\mathbbm{P}, \mathbbm{U}))$.
The set of all pairs $(H(\mathbbm{P}), C(\mathbbm{P}, \mathbbm{U}))$ for any time series described by patterns of length $D$ lies in a compact subset of $\mathbbm R^2$: the Entropy-Complexity plane.
Mart\'{\i}n et al~\cite{martin2006generalized} obtained explicit expressions for the boundaries of this closed manifold, which depend only on the dimension of the probability space considered, that is, $D!$ for the traditional Bandt-Pompe method,
$D! \times D!$ in our case.
Through such a tool it is possible to discover the nature of the series, determining if it corresponds to a chaotic (or other deterministic dynamics) or stochastic sequences.

Algorithm~\ref{alg:watg} outlines our methodology.
Line~\ref{Line:Peano} transforms the input texture patch $P$ in a \mbox{1-D} signal with a Hilbert-Peano sequence.
%
With this, the spatial information is encoded into a one-dimensional signal.
%
Line~\ref{Line:Probs} computes 
the probability distribution of the weighted transition graph induced by the \mbox{1-D} signal.
The WATG function is detailed in Lines~\ref{Line:WATGBegin}--\ref{Line:WATGEnd}.
%
Lines~\ref{Line:Shannon} and~\ref{Line:StatisticalComplexity} compute the two descriptors of the patch.

The \texttt{WATG} function consists of three steps: 
(i)~each sub-sequence of size (dimension) $D$ of observations at delay $\tau$ is transformed into an ordinal pattern using the Bandt-Pompe symbolization (function \texttt{BPSymbolization}, Line~\ref{Line:BP}); 
(ii)~function \texttt{transitions} (Line~\ref{Line:Transitions}) calculates the sequence of alternations of the ordinal patterns; and 
(iii)~function \texttt{weigthGraph} (Line~\ref{Line:WG}) generates the incidence matrix of the graph using the as weights the amplitude differences between the time series elements.
Finally, the probability distribution is obtained by turning the transition matrix into a vector (Line~\ref{Line:WATGEnd}).
These steps are also depicted in Fig.~\ref{fig:WATG}.
%, and are detailed in the following sections.

\begin{algorithm}
	\caption{$H \times C$ point from a patch using WATG}
	\label{alg:watg}                                
	\textbf{Input:} Patch of texture $P$, dimension $D$ and time delay \textbf{$\tau$}\\
	\textbf{Output:} $H \times C$ feature
	\begin{algorithmic}[1]
		\State signal.\mbox{1-D} $\gets$ \texttt{hilbertCurve}($P$) \label{Line:Peano}
		\State Probs $\gets$ \texttt{WATG}(signal.\mbox{1-D}, D, $\tau$) \label{Line:Probs}
		\State H $\gets$ \texttt{ShannonEntropy}(Probs) \label{Line:Shannon}
		\State C $\gets$ \texttt{StatisticalComplexity}(Probs) \label{Line:StatisticalComplexity}
		
		\vspace{0.15cm}
		
		\Function{\texttt{WATG}}{signal.\mbox{1-D}, D, $\tau$}
		\State patterns $\gets$ \label{Line:WATGBegin} \texttt{BPSymbolization}(signal.\mbox{1-D}, D, $\tau$) \label{Line:BP}
		\State transitions $\gets$ \texttt{transitions}(patterns) \label{Line:Transitions}
		\State graph $\gets$ \texttt{weigthGraph}(signal.\mbox{1-D}, transitions) \label{Line:WG}
		\State Probs $\gets$ \texttt{as.vector}(graph) \label{Line:WATGEnd}
		\State \Return Probs
		\EndFunction
	\end{algorithmic}
\end{algorithm}

\begin{figure}
	\centering
	\includegraphics[width=.7\columnwidth]{Figures/methodology.pdf}
	\caption{Outline of the methodology used for the classification of textures.}
	\label{fig:WATG}
\end{figure}

\subsection{Properties}\label{Sec:WATGProperties}

We conducted two experiments to analyze the response of WATG to different noise levels and image rotations.
Our truth is the deterministic image generated by the function:
\begin{equation*}
z(x,y) = \sin (4x + 0.5y), 
\end{equation*}
where  $x, y \in [-2\pi, 2\pi]$.
Fig.~\ref{Fig:TestZ} shows this function as a $128\times128$-pixel patch.

The speckle noise was modeled as outcomes of independent, identically distributed unitary-mean Gamma random variables with shape parameter $L$ (the number of looks, which controls the signal-to-noise ratio)
$W(L) \sim \Gamma(L, L)$,
with $L \in \{1, 100, 150, 200, 250, 300, 350, 400, 450, 500\}$.
The observed images $I(L)$ are the pixelwise product of $z$ and $w(L)$.
Fig.~\ref{Fig:TestZW} shows the product $I(100)$.

\begin{figure}
	\centering
	\subfigure[$z$]{\label{Fig:TestZ}\includegraphics[width = 28mm]{Figures/z.png}}
	\subfigure[$I(100)$]{\label{Fig:TestZW}\includegraphics[width = 28mm]{Figures/z100.png}}
	\subfigure[$I^{\text{T}}(500)$]{\label{Fig:TestRot}\includegraphics[width = 28mm]{Figures/z500t.png}}
	\caption{Ground truth, speckled, and speckled transposed versions.}
	\label{Fig:TestZWL}
\end{figure}

Fig.~\ref{Fig:TestSpeckleHC} shows how the point in the $H\times C$ plane varies according to the level of noise introduced.
The ground truth (identified as ``\textsf{0}'') has relatively low entropy and is close to the maximum complexity (the continuous line is the upper bound).
This behavior is typical of deterministic sequences.
Observe that when we inject single-look speckle ($L=1$), the entropy increases along with the complexity.
Thus, the technique is able to identify the deterministic component even when it is embedded in the strongest possible speckle noise.
The point ``\textsf{1}'' shifts towards ``\textsf{0}'' when the signal-to-noise progressively increases.

\begin{figure}
	\includegraphics[width=0.45\textwidth]{Figures/waves1.pdf}
	\caption{Modifications to the $H \times C$ Plane features by adding different multiplicative noises.}
	\label{Fig:TestSpeckleHC}
\end{figure}

We also verified that the points in the $H\times C$ plane are almost insensitive to rotations.
Fig.~\ref{Fig:TestRot} shows the transpose of $I(500)$.
In all cases, the coordinates $(h,c)$ of the transposed noisy images were equal, up to the fourth decimal place, to those of the original version.

These experiments provide evidence that the WATG mapping is little sensitive to rotations (thanks to the use of Hilbert-Peano curves), and that it can identify the presence of underlying structural information in the presence of varying levels of speckle.

\subsection{Image Datasets}

We used the HH backscatter magnitudes of three quad-polarimetric L-band SAR images from the NASA Jet Propulsion Laboratory’s (JPL’s) uninhabited aerial vehicle synthetic aperture radar (UAVSAR) sensor with $L=36$ nominal looks:
\begin{itemize}
	\item forest and pasture region of Sierra del Lacandón National Park, Guatemala, (acquired on April 10, 2015)\footnote{\protect{\url{https://uavsar.jpl.nasa.gov/cgi-bin/product.pl?jobName=Lacand_30202_15043_006_150410_L090_CX_01\#dados}}}. 
	The image has $8917 \times 3300$ pixels with 
	\SI[inter-unit-product =$\cdot$]{10}{\meter} $\times$ \SI[inter-unit-product =$\cdot$]{2}{\meter} resolution.
	%
	\item ocean regions from Cape Canaveral Ocean (acquired on September 22, 2016).
	The image has $7038 \times 3300$ pixels with 
	\SI[inter-unit-product =$\cdot$]{10}{\meter} $\times$ \SI[inter-unit-product =$\cdot$]{2}{\meter} resolution;
	%
	\item urban area of the city of Munich, Germany (acquired on June 5, 2015)\footnote{\protect{\url{https://uavsar.jpl.nasa.gov/cgi-bin/product.pl?jobName=munich_19417_15088_002_150605_L090_CX_01\#data}}}.
	The image has $5773 \times 3300$ pixels with 
	\SI[inter-unit-product =$\cdot$]{10}{\meter} $\times$ \SI[inter-unit-product =$\cdot$]{3}{\meter} resolution.
\end{itemize}

We manually selected $200$ samples of size $128 \times 128$ to compose the dataset used in the experiments.
It is organized as follows:
$40$ samples from Guatemalan forest regions;
$40$ samples from Guatemalan pasture regions;
$80$ samples from the oceanic regions of Cape Canaveral, divided into two types with different contrast; and
$40$ samples of urban regions of the city of Munich.
Fig.~\ref{fig:samples&Series} shows examples of each. In our analysis, both types of ocean images are grouped.

We randomly split the samples in training (\SI{85}{\percent}) and test (\SI{15}{\percent}) sets.
We used the first set to train a $k$-nearest neighbor classifier algorithm with tenfold
cross-validation.

\begin{figure*}
	\centering
	\subfigure[Forest\label{Fig:figGuatemala}]{\includegraphics[width = 35mm]{Figures/guatemalaflorest.pdf}}
	\subfigure[Sea -- lower contrast\label{Fig:figCape1}]{\includegraphics[width = 35mm]{Figures/Cape1.pdf}}
	\subfigure[Sea -- higher contrast\label{Fig:figCape2}]{\includegraphics[width = 35mm]{Figures/Cape2.pdf}}
	\subfigure[Urban\label{Fig:figMunich}]{\includegraphics[width = 35mm]{Figures/munichUrban.pdf}}
	\subfigure[Pasture\label{Fig:figPasture}]{\includegraphics[width = 35mm]{Figures/pasture.pdf}}
	
	\subfigure[Signal -- forest\label{Fig:TSGuatemala}]{\includegraphics[width = 35mm]{Figures/tsguatemala.pdf}}
	\subfigure[Signal -- sea\label{Fig:TSCape1}]{\includegraphics[width = 35mm]{Figures/tscape1.pdf}}
	\subfigure[Signal -- sea\label{Fig:TSCape2}]{\includegraphics[width = 35mm]{Figures/tscape2.pdf}}
	\subfigure[Signal -- sea\label{Fig:TSMunich}]{\includegraphics[width = 35mm]{Figures/tsmunich.pdf}}
	\subfigure[Signal -- pasture\label{Fig:TSPasture}]{\includegraphics[width = 35mm]{Figures/tspasture.pdf}}
	\caption{Types of regions (Guatemala forest, Canaveral ocean types 1 and 2, Munich urban area, and pasture area) and their signal representation.}
	\label{fig:samples&Series}
\end{figure*}

\section{Results}\label{Results}

In this section, we describe  the classification process, and 
the results of applying WATG.
To assess the performance of the technique here proposed, we analyze the impact of its parameters and compare its results in the classification with other methods.

\subsection{Analysis of ordinal patterns methods}

Fig.~\ref{fig:samples&Series} shows examples of the ocean, forest, urban, and pasture both as image patches and as 1-D sequences after the linearization process.

The variation in the magnitude of the targets' backscatter and, consequently, in the intensity of the image pixels, depends on the intrinsic properties of the region under analysis.
Urban targets usually exhibit the strongest variation, followed by forest, pasture, forests, and finally, water bodies.
By adding such information related to the amplitude, the proposed method is able to increase, compared to traditional methods, the granularity of information captured by ordinal patterns.

\begin{figure*}
	\centering
	\subfigure[Transition Graph\label{Fig:UrbanTG}]{\includegraphics[width = 85mm]{Figures/UrbanTG.pdf}}
	\subfigure[WATG\label{Fig:UrbanWATG}]{\includegraphics[width = 85mm]{Figures/UrbanWATG.pdf}}
	\caption{Difference of edges weights between the transition graph and the weighted graph of ordinal patterns transitions; urban area, with dimension 3 and delay 1.}
	\label{fig:graphs}
\end{figure*}

As already described in Section~\ref{WATG}, our proposal weights the edges in terms of the difference of amplitudes.
As expected, the greatest impact is observed on the transition graphs obtained from urban areas.
The urban area \mbox{1-D} signal shown in Fig.~\ref{fig:samples&Series} has the largest dynamic range.
Fig.~\ref{fig:graphs} shows how this information alters the weights of the transition graph.
Notice, in particular, that 
$(v_{\widetilde \pi^3_{123}}, v_{\widetilde \pi^3_{123}})$ almost doubled, while 
$(v_{\widetilde \pi^3_{312}}, v_{\widetilde \pi^3_{231}})$ and $(v_{\widetilde \pi^3_{213}}, v_{\widetilde \pi^3_{132}})$ became negligible.
We highlight the impact of the weighting on the probability distribution in the two extreme cases observed:
\begin{itemize}
	\item If the \mbox{1-D} signal presents a low amplitude variation and intensity peaks between, then the transitions of ordinal patterns that represent the latter have larger weights.
	This contributes so that the probability distribution becomes less uniform among the symbols since it will be more concentrated in these edges.
	This will also cause a drop in entropy when compared to the traditional method.
	\item In \mbox{1-D} signal that shows a uniform amplitude variation, the weights are well distributed between their edges, giving rise to a more random probability distribution, thus obtaining larger entropy.
\end{itemize}

Fig.~\ref{fig:plotsHC} shows the impact of using the data amplitude information on the weights of the transition graphs.

The Bandt-Pompe symbolization was the first method based on ordinal patterns proposed in the literature.
As shown in Fig.~\ref{fig:plotsHC} left, it provides a limited separation of the textures.
Transition graphs (Fig.~\ref{fig:plotsHC} center) improve the spread of the features, but with some amount of confusion.
Our proposal, shown in Fig.~\ref{fig:plotsHC} right, produces well-separated features.
In this way, we were able to obtain, for this experiment, a perfect characterization and, consequently, the high descriptive power of the regions.

\begin{figure*}
	\includegraphics[width=2\columnwidth]{Figures/HCAnalysis.pdf}
	\caption{Location of Guatemala (forest), Cape Canaveral (ocean), and Munich (urban) in the $H \times C$ plane for dimension 3 and delay 1. 
	The continuous curves correspond to the maximum and minimum values of $C$ as a function of $H$.}
	\label{fig:plotsHC}
\end{figure*}

\subsection{Experiments on sliding window selection}

In this section, we analyze the parameters of the proposed method and its impact on textures classification.
McCullough et al.~\cite{McCullough2015lagged} report that inadequate values may hinder important characteristics of the phenomenon under analysis.
The two parameters of the transition graph are the dimension $D$, and the delay $\tau$.
In the experiments below, we present the results in the classification using different values of these parameters.

The classification method's performance based on ordinal patterns is sensitive to window size, the embedding dimension, and the delay.
In techniques based in Bandt-Pompe symbolization, for a fixed signal, as the size of the embedding dimension decreases, more ordinal patterns are produced.
Therefore, we acquire a higher granularity of information about the dynamics of the system and, consequently, we capture more spatial dependencies between the elements.

Fig.~\ref{fig:ROC} shows the ROC plane for different values of $D \in \{3, 4, 5, 6 \} $ and $\tau \in \{1, 2, 3, 4, 5 \}$ to select the best configuration.
The configurations that extracted most information from the \mbox{1-D} signal and, thus, that presented the best results in the experiments, are $(D = 3, \tau = 1)$ and $(D = 4, \tau = 1)$.
The technique, thus, shows its best performance choosing the parameters with the lowest computational cost.

\begin{figure}
	\includegraphics[width=\columnwidth]{Figures/ROC.pdf}
	\caption{Evaluation of the sliding window parameters using ROC curve}
	\label{fig:ROC}
\end{figure} 

Figure~\ref{fig:Regions} shows the points in the $H\times C$ produced by the same samples with all the parameters mentioned above.
The spatial distribution of the points changes with the parameters and specific configurations promote better separation.
This figure shows that the discrimination ability decreases with increasing $\tau$.
Larger values of delay dilute the spatial dependence, as neighboring points in the sample tend to be more distant in the image.
For this reason, we use $\tau=1$. Figure~\ref{fig:Regions} suggests that only one feature ($H$ or $C$) is sufficient to discriminate the classes studied. Although this is true for the experiments herein conducted, we opt to preserve the most common ordinal pattern analysis, which uses both features. As we studied only homogeneous patches, we still do not know how this approach performs with heterogeneous patches. 
For this last situation, we may need both features.

\begin{sidewaysfigure*}
	\centering
	\includegraphics[width=1\textwidth]{Figures/WATGHC.pdf}
	\caption{Characterization resulting in $H \times C$ Plane from the application of the Hilbert-Peano curve in WATG on textures of different regions: Guatemala (forest), Cape Canaveral (ocean) and Munich (urban). 
	The continuous curves correspond to the maximum and minimum values of $C$ as a function of $H$.}
	\label{fig:Regions}
\end{sidewaysfigure*}

Considering $\tau=1$ (first column of Fig.~\ref{fig:Regions}), 
we also notice that $D=3$ produces the best separation among classes.
Increasing $D$ also increases the Statistical Complexity; this is noticeable for the Forest class.
The other effect of considering larger values of $ D $ is an increased Entropy of Ocean and an undesirable overlap with Urban samples.

\subsection{Quantitative Evaluation}

We present a comparison between our proposal and other methods for texture characterization and classification.
We use the following ten methods: 
Gabor filters~\cite{weldon1996efficient},  
Histogram of oriented gradients (HOG)~\cite{dalal2005histograms},
Gray-level co-occurrence matrices (GLCM)~\cite{kourgli2012texture}, 
Speeded-Up Robust Features (SURF)~\cite{bay2006surf},
Short Time Fourier Transform (STFT)~\cite{portnoff1980time} with SURF,
Bandt-Pompe probability distribution~\cite{Bandt2002Permutation}, 
Ordinal patterns transition graphs~\cite{Borges2019Transition},
Weighted Permutation Entropy (WPE)~\cite{Fadlallah2013Weightedpermutation},
Fine-Grained Permutation Entropy (FGPE)~\cite{xiao2009fine} with $\alpha = 0.5$, and
Amplitude-Aware Permutation Entropy (AAPE)~\cite{azami2016amplitude} with $A = 0.5$.
As in~\cite{guan2019covariance}, 
we computed four statistics from co-occurrence matrices: contrast, correlation, energy, and homogeneity.
Likewise, we implemented the Gabor filters in five scales and eight orientations; using the energy, we obtained an $80$-dimensional feature vector for each patch.
For the HOG technique, we used image pixels divided into equal cells of $3 \times 3$ pixels, and for each cell, we computed 6-bin histograms ranging from \SIrange{0}{180}{\degree} or \SIrange{0}{360}{\degree}.

We classified the features using the $k$-nearest neighbor algorithm with Euclidean distance, selecting the value of $k$ with the automatic grid search method of the Caret R package~\cite{kuhn2008building}.
For validation, we used $10$-fold cross-validation.
More details about the classifier and the sampling can be seen in~\cite{mitchell1997machine}.

Table~\ref{tab:result1} presents the number of features each method produces, as well as its performance at classifying the $200$ samples.
We assessed the effectiveness of each approach using the following metrics. We used the first two metrics (Recall and Precision) to evaluate classifiers' per class performance and the last three metrics (Average Accuracy, Micro F1-score, and Macro F1-score) to evaluate the overall performance of the multi-class classifiers. We denote $\text{TP}_i$, $\text{TN}_i$, $\text{FP}_i$, and $\text{FN}_i$ as the true positives, true negatives, false positives, and false negatives counts of a given class $i$, respectively.
\begin{itemize}
	\item Recall or True Positive Rate of the class $i$ (TPR$_i$): 
	\begin{equation*}
	\text{TPR$_i$} = \frac{\text{TP}_i}{\text{TP}_i + \text{FN}_i}.
	\end{equation*}
	%
	\item Precision or Positive Predictive Value of the class $_i$ (PPV$_i$): \begin{equation*}
	\text{PPV$_i$} = \frac{\text{TP}_i}{\text{TP}_i + \text{FP}_i}.
	\end{equation*}
	%
	\item Average Accuracy (AA): 
	%\begin{equation*}
	%\text{OA} = \frac{\text{TP}_{\text{ocean}} + \text{TP}_{\text{forest}} + \text{TP}_{\text{Pasture}} + \text{TP}_{\text{urban}}}{\text{Total Regions}}.
	%\end{equation*}
	\begin{equation*}
	\text{AA} = \sum^{\text{4}}_{i = 1}\left\{\frac{\text{TP}_i + \text{TN}_i}{\text{TP}_i + \text{TN}_i + \text{FP}_i + \text{FN}_i}\right\} 
	\end{equation*}
	%
	\item Micro F1-score: 
	\begin{equation*}
	\text{PPV}_\mu = \sum^{\text{4}}_{i = 1}\frac{\text{TP}_i}{\text{TP}_i + \text{FP}_i}
	\end{equation*}
	\begin{equation*}
	\text{TPR}_\mu = \sum^{\text{4}}_{i = 1}\frac{\text{TP}_i}{\text{TP}_i + \text{FN}_i}
	\end{equation*}
	\begin{equation*}
	\text{F1-score}_\mu = 2 \times \frac{\text{PPV}_\mu \times \text{TPR}_\mu}{\text{PPV}_\mu + \text{TPR}_\mu}.
	\end{equation*}
	%
	\item Macro F1-score: 
	\begin{equation*}
	\text{PPV}_M = 4 \times \sum^{\text{4}}_{i = 1}\frac{\text{TP}_i}{\text{TP}_i + \text{FP}_i}
	\end{equation*}
	\begin{equation*}
	\text{TPR}_M = 4 \times \sum^{\text{4}}_{i = 1}\frac{\text{TP}_i}{\text{TP}_i + \text{FN}_i}
	\end{equation*}
	\begin{equation*}
	\text{F1-score}_M = 2 \times \frac{\text{PPV}_M \times \text{TPR}_M}{\text{PPV}_M + \text{TPR}_M}.
	\end{equation*}
\end{itemize}

\begin{table*}%[!htb]
	\centering
	\caption{Experimental results using $k$-NN}
	\label{tab:result1}
	\begin{tabular}{lrrrr*9{r}}
		\toprule
		\multirow{2}{*}{Method} & \multirow{2}{*}{\# features} & & TPR & & & & PPV & & & \multirow{2}{*}{AA} & \multirow{2}{*}{$\text{F1-Score}_{\mu}$} & \multirow{2}{*}{$\text{F1-Score}_M$} \\ 
		\cmidrule(lr){3-6} 
		\cmidrule(lr){7-10}
		&   & Forest & Pasture & Ocean & Urban & Forest & Pasture & Ocean & Urban & &  \\ 
		\cmidrule(lr){1-1}
		\cmidrule(lr){2-2}
		\cmidrule(lr){3-6}
		\cmidrule(lr){7-10}
		\cmidrule(lr){11-11}
		\cmidrule(lr){12-12}
		\cmidrule(lr){13-13}
		Gabor & 80 & 
		1.000 & 1.000 & 1.000 & 1.000 & 
		1.000 & 1.000 & 1.000 & 1.000 & 
		1.000 & 1.000 & 1.000\\
		HOG & 54 & 
		1.000 & 1.000 & 1.000 & 1.000 & 
		1.000 & 1.000 & 1.000 & 1.000 & 
		1.000 & 1.000 & 1.000\\
		GLCM & 32 & 
		0.833 & 1.000 & 1.000 & 0.833 &
		1.000 & 0.857 & 0.923 & 1.000 &
		0.967 & 0.980 & 0.970\\
		SURF & 1856 & 
		0.500 & 0.000 & 1.000 & 0.000 & 
		1.000 & 0.000 & 0.444 & 0.000 &
		0.467 & 0.666 & 0.572\\
		STFT + SURF  & 1856 & 
		0.166 & 0.000 & 0.833 & 0.166 & 
		0.250 & 0.000 & 0.416 & 0.500 &
		0.300 & 0.462 & 0.292\\
		\cmidrule(lr){1-1}
		\cmidrule(lr){2-2}
		\cmidrule(lr){3-6}
		\cmidrule(lr){7-10}
		\cmidrule(lr){11-11}
		\cmidrule(lr){12-12}
		\cmidrule(lr){13-13}
		Bandt-Pompe & 2 & 
		0.333 & 1.000 & 0.750 & 1.000 &
		0.500 & 0.857 & 0.750 & 0.857 &
		0.600 & 0.776 & 0.633\\ 
		Transition Graph & 2 & 
		0.833 & 0.666 & 0.833 & 1.000 &
		0.833 & 0.800 & 0.769 & 1.000 &
		0.767 & 0.929 & 0.875\\
		\cmidrule(lr){1-1}
		\cmidrule(lr){2-2}
		\cmidrule(lr){3-6}
		\cmidrule(lr){7-10}
		\cmidrule(lr){11-11}
		\cmidrule(lr){12-12}
		\cmidrule(lr){13-13}
		WPE & 2 & 
		1.000 & 0.833 & 1.000 & 0.833 &
		0.857 & 0.833 & 1.000 & 1.000 &
		0.933 & 0.868 & 0.779\\ 
		AAPE & 2 & 
		0.666 & 1.000 & 1.000 & 1.000 &
		1.000 & 0.857 & 0.923 & 1.000 &
		0.833 & 0.947 & 0.896\\ 
		FGPE & 2 & 
		0.666 & 0.666 & 1.000 & 1.000 &
		0.800 & 0.666 & 0.923 & 1.000 &
		0.767 & 0.868 & 0.711\\ 
		\cmidrule(lr){1-1}
		\cmidrule(lr){2-2}
		\cmidrule(lr){3-6}
		\cmidrule(lr){7-10}
		\cmidrule(lr){11-11}
		\cmidrule(lr){12-12}
		\cmidrule(lr){13-13}
		WATG & 2 & 
		1.000 & 1.000 & 1.000 & 1.000 &
		1.000 & 1.000 & 1.000 & 1.000 &
		1.000 & 1.000 & 1.000\\
		\bottomrule
	\end{tabular}
\end{table*}

Table~\ref{tab:result1} shows that, among the methods of weighting ordinal patterns, FGPE produced the worst results: $\text{AA} = \SI{76.7}{\percent}$, $\text{F1-score}_\mu = \SI{86.8}{\percent}$, and $\text{F1-score}_M = \SI{71.1}{\percent}$.
%
WPE also produced a low F1-score, but it produced consistently better results in the other metrics, presenting $\text{AA} = \SI{93.3}{\percent}$.
%
AAPE achieved one of the best F1-score results: $\text{AA} = \SI{83.3}{\percent}$, $\text{F1-score}_\mu = \SI{94.7}{\percent}$, and $\text{F1-score}_M = \SI{89.6}{\percent}$.
%
WATG, considering the transition graph of ordinal patterns, can better describe the textures presented, as it achieves the best performance achievable in all metrics: \SI{100}{\percent}.

\mbox{STFT + SURF} produced the worst results: $\text{AA} = \SI{30.0}{\percent}$, $\text{F1-score}_\mu = \SI{46.2}{\percent}$, and $\text{F1-score}_M = \SI{29.2}{\percent}$.
%
SURF alone provided a better performance: $\text{AA} = \SI{46.7}{\percent}$,  $\text{F1-score}_\mu = \SI{66.6}{\percent}$, and $\text{F1-score}_M = \SI{57.2}{\percent}$.
%
HOG and Gabor filters achieved the highest success rates
among all the handcrafted methods here considered: $\text{AA} = \SI{100}{\percent}$, $\text{F1-score}_\mu = \SI{100}{\percent}$, and $\text{F1-score}_M = \SI{100}{\percent}$.
However, WATG achieves that same performance using only $2$ features.
This reduction implies less computational power requirement and avoids the curse of dimensionality~\cite{TheCursesofDimensionality2018}.
Moreover, the features it is based upon are fully interpretable.

\section{Conclusions}\label{Conclusion}

We presented and assessed a new method of analysis and classification of SAR image textures.
This method consists of three steps: 
(1)~linearization, 
(2)~computing the Weighted Ordinal Pattern Transition Graph, and 
(3)~obtaining Information Theory descriptors.
A simple $k$-NN algorithm applied to the pairs Entropy-Statistical~Complexity classifies the data with \SI{100}{\percent} performance.
In addition to such perfect separation among urban, pasture, ocean, and forest areas, the proposed descriptors are interpretable in terms of the degree and structure of the spatial dependence among observations.

Experiments using patches from UAVSAR images showed that the proposal performs better than GLCM, Bandt-Pompe, Transition Graphs, SURF, \mbox{STFT + SURF}, and other techniques which also employ amplitude information in the analysis of ordinal patterns. 
Our approach provides the same quality of results obtained with Gabor filters and HOG.
However, while Gabor filters employ $80$ features and HOG uses $54$ features, our proposal requires only two.
This such reduced dimensionality consists of a huge advantage over the other techniques, with added values:
Firstly, by reducing the dimension of the features to \mbox{2-D}, we can visualize the differences between the classes of regions analyzed.
Secondly, for machine learning algorithms, the smaller the number of dimensions, the faster the training process is, and the less storage space is required.
Thirdly, we managed to avoid overfitting, a recurring problem in data with high dimensionality.

We also observed that only one feature ($H$ or $C$) is enough to discriminate the classes with the same reported performance. We opted to preserve both features because we consider that this study shed light on a novel way of SAR image analysis. Thus, we preferred to stick to the most common ordinal pattern analysis using the $H \times C $ plane. As future work, we consider investigating the discriminative power of these features in more complex situations.

Our approach is robust to rotations and the presence of speckle noise. The behavior showed in Figure~\ref{Fig:TestSpeckleHC} shows that our approach can capture the speckle contamination adequately.

Since the application of this work is limited to texture patches from homogeneous regions, we aim to study the possible impacts of heterogeneous areas, such as mixed culture and urban regions.
%\todo[inline]{Acrescentar nas conclusões que podemos usar apenas uma feature.}
%\todo[inline]{Revisitar o experimento do speckle}

\section{Reproducibility and Replicability} 

Following the guidelines presented in Ref.~\cite{ABadgingSystemforReproducibilityandReplicabilityinRemoteSensingResearch}, the text, source code, and data used in this study are available at the \textit{SAR-WATG} repository \url{https://github.com/EduardaChagas/SAR-WATG}.
The information includes a link to download the $200$ labeled samples we employed in the analysis.

\bibliographystyle{IEEEtran}
\bibliography{AbbrevRefs}

\section*{Acknowledgements}\label{ACKNOWLEDGEMENTS}

This work was partially funded by the Coordination for the Improvement of Higher Education Personnel (CAPES) and National Council for Scientific and Technological Development (CNPq).

\end{document}  
